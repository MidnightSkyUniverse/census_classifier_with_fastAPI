schema: '2.0'
stages:
  split_data:
    cmd: python ml/split_data.py
    deps:
    - path: data/census.csv
      md5: 145de00f6e6053d3f7044628f9a5b5ff
      size: 3974474
    - path: ml/split_data.py
      md5: 00e8c582b8daf98e4de9b308e95c9b83
      size: 1379
    params:
      params.yaml:
        modeling.random_state: 42
        modeling.test_size: 0.15
    outs:
    - path: data/test_data.csv
      md5: a9c909bff38974cea06a2624322f7f85
      size: 527086
    - path: data/trainval_data.csv
      md5: ddff0571f7026dba090b1f018c762d5f
      size: 2991674
  process_data:
    cmd: python ml/process_data.py
    deps:
    - path: data/trainval_data.csv
      md5: ddff0571f7026dba090b1f018c762d5f
      size: 2991674
    - path: ml/process_data.py
      md5: 18ef2b21695959d79b04f9128594f0d9
      size: 4435
    params:
      params.yaml:
        cat_features:
        - workclass
        - education
        - marital-status
        - occupation
        - relationship
        - race
        - sex
        - native-country
        label: salary
        train.true_: true
    outs:
    - path: data/X.npy
      md5: ddb8ba65fa6c528fefe5733549e7346d
      size: 23912192
    - path: data/y.npy
      md5: 27206b3098126af65f47978e632163c4
      size: 221536
    - path: model/encoder.pkl
      md5: cda18c6561b7ef57f19f48d00d3ff62b
      size: 3898
    - path: model/lb.pkl
      md5: 5025695085b01a6b6c57df2159831c2d
      size: 403
  kfold:
    cmd: python ml/kfold.py
    deps:
    - path: data/trainval_data.csv
      md5: ddff0571f7026dba090b1f018c762d5f
      size: 2991674
    - path: ml/kfold.py
      md5: 4791e2edf490f6e667f22305c657a118
      size: 2347
    params:
      params.yaml:
        modeling.n_splits: 5
        modeling.random_state: 42
        modeling.shuffle: true
    outs:
    - path: metrics/kfold_scores.json
      md5: 80c3d32c5a0f06b856735f7f3a24fd3c
      size: 106
  train_predict:
    cmd: python ml/train_predict.py
    deps:
    - path: data/X.npy
      md5: ddb8ba65fa6c528fefe5733549e7346d
      size: 23912192
    - path: data/y.npy
      md5: 27206b3098126af65f47978e632163c4
      size: 221536
    - path: ml/train_predict.py
      md5: 08b0b6bbc838d114ca9d021b86f74f05
      size: 2141
    params:
      params.yaml:
        modeling.random_state: 42
        modeling.test_size: 0.15
    outs:
    - path: metrics/model_scores.json
      md5: f138e66e240123f260919250bb3584ab
      size: 106
    - path: model/model.pkl
      md5: 40254a5a9c415fd8db052ddbe7e7aa78
      size: 59689975
